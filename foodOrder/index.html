<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Vite App</title>

    <script src="https://cdn.tailwindcss.com"></script>
    <script src="//unpkg.com/alpinejs" defer></script>
  </head>
  <body>
    <div
      class="
        antialiased max-w-md mx-auto h-screen max-h-screen bg-gray-100
        flex flex-col
      "
    >
      <div class="h-40 bg-cover" style="background-image: url(https://images.unsplash.com/photo-1623156346149-d5cec8b29818?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1631&q=80)">
        <div class="flex items-center justify-between px-4 h-16 text-white">
          <a class="hover:cursor-pointer hover:opacity-80" href="../index.html">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-6 h-6">
              <path fill-rule="evenodd" d="M7.72 12.53a.75.75 0 010-1.06l7.5-7.5a.75.75 0 111.06 1.06L9.31 12l6.97 6.97a.75.75 0 11-1.06 1.06l-7.5-7.5z" clip-rule="evenodd" />
            </svg>
         </a>
          <div class="flex space-x-4">
            <div class="hover:cursor-help hover:opacity-80">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-6 h-6">
                <path d="M11.645 20.91l-.007-.003-.022-.012a15.247 15.247 0 01-.383-.218 25.18 25.18 0 01-4.244-3.17C4.688 15.36 2.25 12.174 2.25 8.25 2.25 5.322 4.714 3 7.688 3A5.5 5.5 0 0112 5.052 5.5 5.5 0 0116.313 3c2.973 0 5.437 2.322 5.437 5.25 0 3.925-2.438 7.111-4.739 9.256a25.175 25.175 0 01-4.244 3.17 15.247 15.247 0 01-.383.219l-.022.012-.007.004-.003.001a.752.752 0 01-.704 0l-.003-.001z" />
              </svg>
            </div>
            <div class="hover:cursor-help hover:opacity-80">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-6 h-6">
                <path fill-rule="evenodd" d="M15.75 4.5a3 3 0 11.825 2.066l-8.421 4.679a3.002 3.002 0 010 1.51l8.421 4.679a3 3 0 11-.729 1.31l-8.421-4.678a3 3 0 110-4.132l8.421-4.679a3 3 0 01-.096-.755z" clip-rule="evenodd" />
              </svg>
          </div>
          </div>
        </div>
      </div>
      <div class="h-28 px-4 -mt-14">
        <div class="bg-white h-28 rounded-lg p-4">
          <!-- layout -->
          <div class="w-full h-6 flex flex-between max-w-md">
            <div class="w-4/5 h-6 truncate">
              <span class="font-extrabold">Mcdonald's (龍園店 Dragon Garden)</span>
            </div>
            <div class="w-1/5 h-12 truncate">
              <div class="w-12 h-12 bg-cover rounded-lg float-right" style="background-image: url(https://th.bing.com/th/id/R.7c83fc985cae92428ce6db66d48e31ab?rik=koavQCnY1ktuhw&pid=ImgRaw&r=0)"></div>
            </div>
          </div>
        <div class="relative bottom-1 w-[80%] h-12 flex justify-between items-center">
          <div class="flex justify-center items-center truncate">
            <svg xmlns="http://www.w3.org/2000/svg" fill="rgb(227,162,79)" viewBox="0 0 24 24" stroke-width="1.5" stroke="rgb(227,162,79)" class="w-4 h-4">
            <path stroke-linecap="round" stroke-linejoin="round" d="M11.48 3.499a.562.562 0 011.04 0l2.125 5.111a.563.563 0 00.475.345l5.518.442c.499.04.701.663.321.988l-4.204 3.602a.563.563 0 00-.182.557l1.285 5.385a.562.562 0 01-.84.61l-4.725-2.885a.563.563 0 00-.586 0L6.982 20.54a.562.562 0 01-.84-.61l1.285-5.386a.562.562 0 00-.182-.557l-4.204-3.602a.563.563 0 01.321-.988l5.518-.442a.563.563 0 00.475-.345L11.48 3.5z" />
            </svg>
            <span class="pl-1 text-sm text-[rgb(227,162,79)]">4.6</span>
            </div>
          <div class="w-auto flex justify-center items-center truncate">
            <svg xmlns="http://www.w3.org/2000/svg" fill="rgb(94,242,129)" viewBox="0 0 24 24" stroke-width="1.5" stroke="rgb(94,242,129)" class="w-4 h-4 pl-1">
              <path stroke-linecap="round" stroke-linejoin="round" d="M6 12L3.269 3.126A59.768 59.768 0 0121.485 12 59.77 59.77 0 013.27 20.876L5.999 12zm0 0h7.5" />
            </svg>
            <span class="pl-1 text-sm text-[rgb(205,209,206)]">距離 125m</span>
          </div>
          <div class="flex justify-center items-center truncate">
            <svg xmlns="http://www.w3.org/2000/svg" fill="rgb(242,175,15)" viewBox="0 0 24 24" stroke-width="1.5" stroke="rgb(242,175,15)" class="w-4 h-4 pl-1">
              <path stroke-linecap="round" stroke-linejoin="round" d="M2.25 3h1.386c.51 0 .955.343 1.087.835l.383 1.437M7.5 14.25a3 3 0 00-3 3h15.75m-12.75-3h11.218c1.121-2.3 2.1-4.684 2.924-7.138a60.114 60.114 0 00-16.536-1.84M7.5 14.25L5.106 5.272M6 20.25a.75.75 0 11-1.5 0 .75.75 0 011.5 0zm12.75 0a.75.75 0 11-1.5 0 .75.75 0 011.5 0z" />
            </svg>
            <span class="pl-1 text-sm text-[rgb(205,209,206)]">Mfood送: 11分鐘</span>
            
          </div>
          </div>
          <div class="relative bottom-2 w-full h-8 truncate">
            <span class="relative text-[rgb(205,209,206)]">公告: 外送價格和活動與堂食不同。為支持環保，部分飲料我們將不再主動配備飲管，你可通過"無吸管"杯蓋直接飲用。</span>
          </div>
        </div>
        
        </div>

      <div
        x-data="{
          items: ['點餐', '評價', '資料'],
          currentIndex: 0,
        }"
        class="relative mt-4 font-extrabold"
      >
        <div>
          <ul class="flex">
            <template x-for="(item, index) in items" :key="index">
              <li class="w-1/3 text-center">
                <button
                  x-text="item"
                  @click="currentIndex = index"
                >
                </button>
              </li>
            </template>
          </ul>

          <div class="absolute w-full">
            <div
              class="w-1/3 transform transition"
              :class="{
                'translate-x-[44%]': currentIndex === 0,
                'translate-x-[144%]': currentIndex === 1,
                'translate-x-[244%]': currentIndex === 2,
              }"
            >
              <div class="w-4 h-1 bg-[rgb(242,138,15)]"></div>
            </div>
          </div>
        </div>
        <div class="rounded-xl m-auto mt-2 w-[90%] h-2 flex justify-center items-center">
        
      </div>
      </div>

      <div
        class="mt-2 flex-1 flex overflow-hidden"
        x-data="{
          loading: true,
          categories: [],
          currentCategoryIndex: 0,
          clickCategory: function(index) {
            this.currentCategoryIndex = index
            $refs['rightCategoryList'].querySelectorAll('.category-title2')[index].scrollIntoView({
              block: 'start',
              behavior: 'smooth'
            })
          }
        }"
        x-init="
          setTimeout(() => {
            fetch('./public/data/data.json')
              .then(res => res.json())
              .then(data => {
                // console.log(data)
                categories = data

                $nextTick(() => {
                  $refs['rightCategoryList'].querySelectorAll('.category-title').forEach((el, i) => {
                    // console.log(el)

                    const observer = new window.IntersectionObserver(([entry]) => {
                      if (entry.isIntersecting) {
                        console.log('ENTER', el.innerHTML, i)
                        currentCategoryIndex = i

                        // console.log(Array.from($refs['leftCategoryList'].querySelectorAll('.category-item'))[currentCategoryIndex])
                        Array.from($refs['leftCategoryList'].querySelectorAll('.category-item'))[currentCategoryIndex]
                          .scrollIntoView({block: 'end', behavior: 'smooth'})

                        return
                      }
                      console.log('LEAVE', i)

                    }, {
                      root: null,
                      threshold: 0.1, // set offset 0.1 means trigger if atleast 10% of element in viewport
                    })

                    observer.observe(el);
                  })
                })
              })
            loading = false
          }, 500)
        "
      >
        <template x-if="loading">
          <span>Loading...</span>
        </template>
        <template x-if="!loading">
          <div class="flex-1 flex">
            <div x-ref="leftCategoryList" class="w-1/4 overflow-auto bg-gray-100">
              <template x-for="(category, index) in categories" :key="index">
                <div
                  class="category-item h-24 flex flex-col rounded-xl overflow-hidden items-center justify-center transition"
                  :class="{
                    'bg-white': currentCategoryIndex === index
                  }"
                  @click="clickCategory(index)"
                >
                  <img :src="category.imgUrl" class="h-10" />
                  <div x-text="category.title" class="truncate text-xs font-semibold mt-1"></div>
                </div>
              </template>
            </div>
            <div x-ref="rightCategoryList" class="w-3/4 overflow-auto bg-white">
              <template x-for="(category, i) in categories" :key="i">
                <div>
                  <div x-text="category.title" class="category-title z-20 sticky top-0 p-4 bg-white text-gray-500 font-extrabold"></div>
                  <span class="category-title2"></span>

                  <div class="space-y-4">
                    <template x-for="(food, j) in category.foods" :key="j">
                      <div class="flex h-32 space-x-2">
                        <div class="pl-4 w-1/3">
                          <img :src="food.imgUrl" class="h-20 bg-gray-100 rounded-lg" />
                        </div>
                        <div class="w-2/3">
                          <div class="font-extrabold whitespace-nowrap" x-text="food.name"></div>
                          <div class="pl-[0.1rem] pt-2 text-sm" x-text="food.description"></div>
                          <div class="pl-[0.2rem] pt-2 text-sm text-gray-500">月售 <span x-text="food.sold"></span></div>
                          <div class="flex justify-between items-center">
                            <div class="pt-2 text-[1rem] font-extrabold text-red-500">Mop<span class="text-xl" x-text="food.price"></span><span> 起</span></span></div>
                            <div class="relative right-4 w-14 h-7 mt-auto rounded-md bg-[rgb(255,136,12)] text-[rgb(255,193,129)] flex justify-center items-center hover:opacity-80">
                              <span class="p-4 text-sm whitespace-nowrap">選規格</span>
                            </div>
                          </div>
                        </div>
                      </div>
                    </template>
                  </div>
                </div>
              </template>
            </div>
          </div>
        </template>
        <div class="justify-center max-w-md m-auto z-50 h-12 fixed bottom-0 rounded-xl px-4 bg-[rgb(57,52,80)] flex">
          <div class="w-1/5 flex justify-center items-center">
            <img src="https://gamepedia.cursecdn.com/minecraft_gamepedia/archive/b/b3/20110926125703!Chest.png" alt="">
          </div>
          
          <div class="w-3/5 mt-2">
            <div class="pl-4 text-sm font-bold text-white">MOP <span class="text-md">0</span></div>
            <div class="pl-4 text-sm font-bold text-[rgb(186,184,196)]">預估配送費 MOP7 <del class="text-[rgb(111,110,112)]">Mop14</del></div>
          </div>
  
          <div class="w-1/5 mt-1 flex items-center">
            <div class="text-sm font-extrabold text-[rgb(186,184,196)] whitespace-nowrap">MOP90 起送</div>
            </div>
        </div>
      </div>
      </div>
    <!-- <div id="app"></div>
    <script type="module" src="/main.js"></script> -->
  </body>
</html>
